# 无限飞机 - 武器设计文档

*最后更新: 2026-02-27*
*数据来源: WeaponDefs.js 实际代码*

---

## 通用设计原则

### 伤害公式
```
实际伤害 = baseAttack × basePct × (1 + damageLv × 0.5) × 其他乘数
```
- `baseAttack`: 玩家基础攻击力（1 + 永久升级加成）
- `basePct`: 武器基础伤害百分比
- `damageLv`: 伤害分支等级（每级+50%）

### 冷却机制
- **标准模式**: 释放后立即开始冷却
- **持续型武器**: 持续时间结束后才进入冷却（回旋刃、离子射线）

### 战斗内升级树
- 基础分支: 无前置，直接可升
- 进阶分支: 需前置条件（部分受武器商店等级门控）
- 终极分支: 多前置，强力效果

### 章节解锁
| 章节 | 解锁武器 |
|------|---------|
| 1 | 光能寒冰弹、闪电链、穿甲弹、轰炸机 |
| 10 | 战术无人机 |
| 15 | 回旋刃 |
| 25 | 白磷弹 |
| 40 | 离子射线 |
| 55 | 寒冰发生器 |
| 70 | 奇点引擎 |

---

## 1. 光能寒冰弹 (kunai)

**定位**: AOE范围输出，清密集砖块

| 属性 | 值 |
|------|-----|
| icon | 💣 |
| color | #00FFFF |
| basePct | 2.0 |
| interval | 2700ms |

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| damage | 伤害 | +50%基础伤害 | 5 | - |
| count | 弹数 | +1发炮弹 | 3 | - |
| aoe | 爆炸范围 | +25%爆炸半径，弹体变大 | 3 | - |
| speed | 冷却缩减 | -20%技能CD | 3 | - |
| pierce | 穿透 | 穿透砖块，最后一击爆炸 | 2 | count:2 |
| pierceBlast | 穿透爆炸 | 每次穿透都爆炸 | 1 | pierce:2 |
| homing | 制导 | 炮弹追踪最近砖块 | 2 | speed:2 |
| chain | 连锁爆炸 | 被击杀砖块也会爆炸 | 2 | aoe:2, damage:2 |
| giant | 巨型弹头 | 弹体+爆炸范围翻倍 | 1 | aoe:3, pierce:2 |

---

## 2. 闪电链 (lightning)

**定位**: 链式传导，分散目标高效

| 属性 | 值 |
|------|-----|
| icon | ⚡ |
| color | #FFF050 |
| basePct | 1.5 |
| interval | 3000ms |

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| damage | 伤害 | +50%基础伤害 | 5 | - |
| chains | 链数 | +1跳跃目标 | 4 | - |
| freq | 频率 | -20%冷却 | 3 | - |
| paralyze | 麻痹 | 命中减速30% | 2 | chains:2 |
| storm | 雷暴 | 同时释放2道闪电 | 2 | freq:2 |
| charge | 蓄能 | 每次链跳+25%伤害 | 2 | chains:2 |
| shock | 感电 | 命中留DOT(20%/秒×2秒) | 2 | damage:2 |
| echo | 回响 | 链末端20%再次释放 | 2 | chains:3 |
| overload | 超载 | 链末端爆炸AOE | 1 | chains:4, damage:3 |

---

## 3. 穿甲弹 (missile)

**定位**: 纵向穿透，贯穿整列砖块

| 属性 | 值 |
|------|-----|
| icon | 🎯 |
| color | #FF14FF |
| basePct | 8.0 |
| interval | 2500ms |
| basePierce | 5 |
| decayRate | 0.15 (每穿一个衰减15%) |

### 核心机制
- 从飞机发射（单管从中心，双管从两侧），方向固定向上
- 贯穿同列砖块，默认穿透5个，每穿一个衰减15%伤害
- 弹体随升级变大变猛（4档视觉tier）

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| damage | 穿甲强化 | +50%基础伤害，弹体变大 | 5 | - |
| pierce | 贯穿 | 穿透衰减-15%(15%→0%) | 2 | - |
| salvo | 连射 | +1发连射(同列间隔200ms) | 3 | - |
| freq | 装填加速 | -20%冷却 | 3 | - |
| dotExploit | 烈性反应 | 对有DOT砖块每层+20%伤害 | 3 | damage:2 |
| deepPierce | 深度贯穿 | +3穿透数(5→8→11) | 2 | pierce:2 |
| hyperVelocity | 超速弹 | 每穿一个+20%伤害（越打越疼） | 1 | deepPierce:2, damage:3 |
| twinCannon | 双管炮 | 左右侧翼各一管 | 2 | salvo:2 |
| shockwave | 冲击波 | 穿透时向两侧横向溅射50%伤害 | 2 | damage:2, pierce:1 |

---

## 4. 轰炸机 (meteor)

**定位**: 地毯轰炸，水平大范围AOE

| 属性 | 值 |
|------|-----|
| icon | ✈ |
| color | #FF8800 |
| basePct | 6.0 |
| interval | 8000ms |
| baseBombs | 4 |

### 核心机制
- 轰炸机从屏幕左/右侧飞入，自动选砖块最密集的y行
- 水平穿越屏幕，沿途投弹（按屏幕空间等分投弹点）
- 炸弹从机腹投下，受重力加速落向目标行
- 目标行最低限制屏幕25%高度，避免高处漏伤

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| damage | 装药强化 | +50%炸弹伤害 | 5 | - |
| bombs | 载弹量 | +2颗炸弹/次出击 | 3 | - |
| radius | 爆破范围 | +25%爆炸半径 | 3 | - |
| freq | 出击频率 | -15%冷却 | 3 | - |
| napalm | 凝固汽油 | 落点留燃烧区域(DOT 3秒) | 2 | damage:2 |
| carpet | 地毯轰炸 | 飞行路径变宽，上下各多炸一行 | 2 | bombs:2 |
| escort | 护航编队 | +1架僚机同时出击(上下错开) | 2 | freq:2 |
| incendiary | 燃烧风暴 | 燃烧区域合并扩大+50%伤害 | 1 | napalm:2, radius:2 |
| b52 | 战略轰炸 | 巨型机，弹数×2+范围×1.5+屏震 | 1 | escort:1, carpet:1 |

---

## 5. 战术无人机 (drone)

**定位**: 激光阵型，持续切割（Ch10解锁）

| 属性 | 值 |
|------|-----|
| icon | 🤖 |
| color | #50FFB4 |
| basePct | 1.2 |
| interval | 450ms (射击间隔) |

### 核心机制
- 无人机飞到砖块区域自主布阵
- 全连接图激光网：2台=1线，3台=3线(△)，4台=6线(◇)，5台=10线(★)
- 智能追踪：每台独立追踪高权重砖块(y越大权重越高)

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| damage | 伤害 | +50%激光伤害 | 5 | - |
| count | 阵列 | +1台(2→3△→4◇→5★) | 3 | - |
| speed | 机动 | 阵型移动+tick频率提升30% | 3 | - |
| width | 光束 | 激光变粗+判定+40% | 2 | damage:2 |
| deploy | 部署 | 阵型半径+25,追踪更准 | 2 | count:1 |
| arc | 电弧 | 激光线释放电弧扩大范围 | 2 | count:2 |
| overcharge | 过载 | 阵型中心交叉点伤害×2 | 1 | count:2, damage:3 |
| focus | 聚焦 | 对低HP砖额外+80%伤害 | 2 | damage:3, width:1 |
| pulse | 脉冲 | 每4秒阵型AOE爆发×4 | 1 | damage:4, arc:2 |

---

## 6. 回旋刃 (spinBlade)

**定位**: 后排清扫器，持续型大招（Ch15解锁）

| 属性 | 值 |
|------|-----|
| icon | 🌀 |
| color | #AA44FF |
| basePct | 0.8 |
| interval | 8000ms (冷却) |
| tickInterval | 200ms |

### 核心机制
- **上冲阶段**: 从飞机发射快速冲顶
- **横扫阶段**: 到达顶部后横向移动，追踪砖块密度高的区域
- **持续型冷却**: 旋刃存在时不计时，全部消失后才冷却
- **默认贯穿**: 每tick命中所有接触的砖块

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| damage | 伤害 | +50%基础伤害 | 5 | - |
| duration | 续航 | +2秒存在时间 | 3 | - |
| giant | 巨型化 | 旋刃变大+判定范围↑ | 3 | - |
| pierce | 锋锐 | 贯穿伤害+30% | 1 | damage:2 |
| shockwave | 回旋斩 | 弹墙时释放环形刀气波 | 2 | damage:2 |
| ramp | 蓄势 | 存活每秒+12%伤害 | 3 | duration:2 |
| bleed | 撕裂 | 命中留DOT(15%/秒×2秒) | 2 | damage:3 |
| linger | 滞留 | 结束后原地旋转2秒 | 2 | duration:2, giant:1 |
| split | 分裂 | 结束后分裂2个小旋刃 | 2 | duration:2, damage:2 |
| superBlade | 超级旋刃 | 华丽特效+伤害频率翻倍 | 1 | giant:3, damage:3 |

---

## 7. 白磷弹 (blizzard)

**定位**: 范围燃烧DOT，持续区域伤害（Ch25解锁）

| 属性 | 值 |
|------|-----|
| icon | ☢ |
| color | #FF8833 |
| basePct | 1.0 |
| interval | 7000ms |

### 核心机制
- 从天而降的白磷弹，落地后燃烧引燃周边砖块
- 产生持续燃烧区域，tick式伤害
- 可附加减速、DOT叠加、蔓延等效果

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| damage | 伤害 | +50%燃烧伤害 | 5 | - |
| radius | 范围 | +25%燃烧半径 | 3 | - |
| duration | 持续 | +1.5秒燃烧时间 | 3 | - |
| freq | 频率 | -15%冷却 | 3 | - |
| count | 弹数 | +1发白磷弹 | 2 | freq:1 |
| slow | 灼烧 | 砖块下移减速15% | 3 | radius:1 |
| frostbite | 腐蚀 | 附加持续伤害DOT | 2 | damage:2 |
| shatter | 引燃 | 火焰蔓延+结束爆燃 | 2 | radius:2, damage:2 |
| permafrost | 烈焰 | 燃烧频率提升 | 1 | slow:2, duration:2 |

---

## 8. 离子射线 (ionBeam)

**定位**: 锁定单体持续射击，标记叠加增伤（Ch40解锁）

| 属性 | 值 |
|------|-----|
| icon | ⊕ |
| color | #FF4444 |
| basePct | 3.2 |
| interval | 4500ms |

### 核心机制
- 自动锁定最强目标（HP最高的砖块）持续射击
- 标记系统：每次命中叠加标记，每层增伤
- 蓄能首击：第一击有额外爆发倍率
- 过载爆炸：射击结束时目标点AOE

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| damage | 伤害 | +50%射线伤害 | 5 | - |
| duration | 持续 | +1秒射击时间 | 3 | - |
| freq | 充能 | -20%充能CD | 3 | - |
| mark | 标记 | 每次命中+1层，每层+8%伤害 | 3 | damage:1 |
| pierce | 穿透 | 射线穿透打击后方目标 | 2 | damage:2 |
| split | 分裂 | 命中点溅射周围敌人 | 2 | duration:1 |
| charge | 蓄能 | 首击爆发×(2.5+1.5×等级) | 2 | freq:2 |
| overload | 过载 | 射击结束时AOE爆炸 | 2 | damage:3, duration:2 |
| superOrb | 离子球 | 蓄能释放超级离子球，巨额伤害+击退 | 2 | overload:1 |

---

## 9. 寒冰发生器 (frostStorm)

**定位**: 冰墙屏障，消耗HP阻挡+控制（Ch55解锁）

| 属性 | 值 |
|------|-----|
| icon | ❄ |
| color | #44DDFF |
| basePct | 40.0（冰墙总HP） |
| interval | 6000ms |

### 核心机制
- 在砖块前方生成冰晶屏障（冰墙）
- 砖块撞击冰墙时互相消耗HP，完成伤害
- 5层冰缓体系：砖块碰撞叠加冰缓层数，满5层可触发冻结
- 冰墙碎裂时AOE溅射（升级后）
- 通用冰缓机制：即时碰撞，列融合

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| **堡垒线** | | | | |
| damage | 强化 | +50%冰墙HP | 5 | - |
| stack | 叠甲 | 叠加上限+1倍,叠加触发冰冻脉冲 | 2 | damage:2 |
| frostArmor | 寒霜护甲 | 撞墙额外+1冰缓/级,碰撞伤害+30%/级 | 3 | stack:1 |
| **控制线** | | | | |
| freeze | 冻结 | 撞墙每tick多叠1层冰缓(加速叠满) | 2 | - |
| aura | 寒气场 | 冰墙周围80px范围叠冰缓 | 2 | freeze:2 |
| permafrost | 冰封 | 满5层触发冻结(1s+0.5s/级,不消耗墙HP) | 2 | aura:1, damage:2 |
| **扩张线** | | | | |
| freq | 频率 | CD-1秒/级(6→5→4→3) | 3 | - |
| count | 数量 | 场上+1面墙(2→3→4) | 2 | freq:1 |
| shatter | 碎冰 | 碎裂时AOE溅射(maxHP×50%伤害) | 2 | count:1, freq:2 |

### 冰缓体系（v2 大重构 2026-02-25）
- 通用5层冰缓：所有冰系效果共享
- 即时碰撞：砖块接触冰墙立即生效
- 列融合：同列相邻冰墙自动合并

---

## 10. 奇点引擎 (gravityWell)

**定位**: 黑洞吸引+负能量湮灭，策略型大招（Ch70解锁）

| 属性 | 值 |
|------|-----|
| icon | 🕳 |
| color | #AA00FF |
| basePct | 40.0（总伤害预算） |
| interval | 10000ms |

### 核心机制
1. **黑洞吸引**: 发射黑洞到密集区，持续吸引砖块向中心
2. **百分比HP伤害**: 每tick造成砖块HP上限×N%伤害（上限baseAttack×15）
3. **负能量砖块**: 黑洞结束时，累积的能量伤害×转化率 生成负能量砖块（显示负数HP）
4. **湮灭反应**: 负能量砖块与正常砖块接触 → 互相抵消HP → 触发湮灭爆炸
5. 吸引范围内砖块**禁止融合**（保持分散配合AOE）

### 升级分支

| 分支 | 名称 | 描述 | 最大等级 | 前置 |
|------|------|------|----------|------|
| **吞噬线** | | | | |
| damage | 引力强化 | 吸力+20%/级，范围+12px/级 | 5 | - |
| horizon | 事件视界 | 每tick额外造成HP上限×2%/级伤害 | 2 | damage:2 |
| singularity | 奇点 | 持续+1.5s/级，中心30px伤害翻倍 | 2 | horizon:1 |
| **湮灭线** | | | | |
| negaEnergy | 负能量 | 黑洞结束生成负能量砖，转化率+10%/级 | 3 | - |
| darkMatter | 暗物质 | 负能量体积+30%/级，存活时间无限 | 2 | negaEnergy:2 |
| annihilate | 湮灭链 | 湮灭冲击波溅射，范围+20px/级 | 2 | darkMatter:1, damage:3 |
| **扩张线** | | | | |
| freq | 频率 | CD-2s/级(10→8→6→4) | 3 | - |
| count | 双星系统 | 同时+1个黑洞/级 | 2 | freq:1 |
| lens | 引力透镜 | 范围内能量伤害+12%/级，闪电链跳距+50% | 2 | count:1, freq:2 |

> 详细设计见 `GDD_GRAVITY_WELL.md`

---

## 飞机（主炮）

### 飞机升级树 (ShipDefs.js)

| 分支 | 名称 | 描述 | 最大等级 | 前置 | 品质 |
|------|------|------|----------|------|------|
| **基础线** | | | | | |
| attack | 子弹伤害 | +50%子弹伤害 | 5 | - | normal |
| fireRate | 射速 | +50%射速 | 4 | - | normal |
| **弹道线** | | | | | |
| spread | 散射弹道 | +1子弹散射数 | 3 | - | rare |
| pierce | 穿透弹 | 子弹穿透+1层 | 5 | - | rare |
| **反弹线** | | | | | |
| wallBounce | 边界反弹 | 子弹碰墙反弹，反弹+25%伤 | 3 | - | rare |
| ricochet | 弹射反弹 | 碰砖后弹向附近目标+1 | 3 | wallBounce:1 | rare |
| **进阶** | | | | | |
| barrage | 弹幕风暴 | 每3秒全屏散射 | 3 | fireRate:2 | rare |
| **元素线（三选一互斥）** | | | | | |
| fireBullet | 火焰弹 | 命中附灼烧DOT | 3 | - | exclusive |
| iceBullet | 寒冰弹 | 命中叠冰缓，满5层冻结 | 3 | - | exclusive |
| thunderBullet | 雷电弹 | 命中感电，受伤概率电弧 | 3 | - | exclusive |
| **火进阶** | | | | | |
| fireSpread | 引燃蔓延 | 灼烧砖被毁时火焰扩散 | 2 | fireBullet:1 | rare |
| fireExplosion | 余烬爆破 | 灼烧结束时爆炸AOE | 2 | fireBullet:2 | rare |
| **冰进阶** | | | | | |
| iceFreeze | 冰封禁锢 | 满5层冻结2秒+受伤+50% | 2 | iceBullet:1 | rare |
| iceShatter | 碎冰迸射 | 冻结砖被毁时碎裂伤周围 | 2 | iceBullet:2 | rare |
| **雷进阶** | | | | | |
| shockMark | 超导标记 | 感电砖受攻击+15%×层数 | 2 | thunderBullet:1 | rare |
| shockField | 雷暴领域 | 电弧区域留电场3秒 | 2 | thunderBullet:2 | rare |

---

## 伤害统计来源标识

| 标识 | 中文名 | 来源 |
|------|--------|------|
| bullet | 飞机子弹 | 主炮 |
| fireBullet | 火焰弹 | 元素子弹 |
| iceBullet | 寒冰弹 | 元素子弹 |
| thunderBullet | 雷电弹 | 元素子弹 |
| kunai | 光能寒冰弹 | 炮弹直击 |
| kunai_blast | 迫击AOE | 爆炸范围 |
| kunai_chain | 迫击连锁 | 连锁爆炸 |
| lightning | 闪电链 | 主链 |
| lightning_blast | 闪电爆炸 | 超载终结 |
| shock | 感电 | 闪电DOT |
| armorPiercing | 穿甲弹 | 主体穿透 |
| armorPiercing_shockwave | 穿甲冲击波 | 横向溅射 |
| bomber | 轰炸机 | 炸弹爆炸 |
| bomber_napalm | 凝固汽油 | 燃烧区域 |
| drone | 无人机阵 | 激光线 |
| drone_arc | 无人机电弧 | 电弧扩展 |
| drone_cross | 无人机过载 | 交叉点 |
| drone_pulse | 无人机脉冲 | AOE爆发 |
| spinBlade | 回旋刃 | tick伤害 |
| spinBlade_sw | 回旋斩 | 弹墙刀气波 |
| bleed | 撕裂DOT | 回旋刃效果 |
| phosphorus | 白磷弹 | 主体伤害 |
| phosphorus_dot | 白磷燃烧 | 持续灼烧 |
| ionBeam | 离子射线 | 主体射线 |
| ionBeam_overload | 离子过载 | 结束爆炸 |
| ionOrb | 离子球 | 超级离子球 |
| iceWall | 寒冰发生器 | 冰墙碰撞 |
| iceWall_shatter | 碎冰溅射 | 碎裂AOE |
| gravityWell | 奇点引擎 | 黑洞tick伤害 |
| negaEnergy | 负能量湮灭 | 湮灭爆炸 |
