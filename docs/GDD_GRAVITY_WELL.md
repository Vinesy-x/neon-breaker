# 奇点引擎（Singularity Engine）— 武器设计文档

> 版本: v1.0 | 2026-02-25
> key: gravityWell | 主色: #AA00FF | 伤害类型: energy

---

## 1. 核心机制

### 1.1 黑洞吸引
- 发射黑洞到砖块密集区域，持续吸引大范围砖块向中心移动
- 吸引范围内砖块**禁止融合**（保持分散，配合闪电链AOE）
- 黑洞自身每tick对范围内砖块造成**能量伤害**

### 1.2 百分比HP伤害
- 技能升级后：每tick额外造成砖块HP上限×N%伤害
- **倍数上限**：单tick不超过 baseAttack × 15，防止Boss被秒

### 1.3 负能量砖块（核心玩法）
- 黑洞存续期间，记录范围内砖块受到的**所有能量系伤害**
  - 能量伤害来源：离子射线、闪电链、黑洞自身
- 黑洞结束时，在中心生成一个**负能量砖块**
- 负能量砖块显示**负数HP**（如 -3500），暗紫色反色渲染
- **可同时存在多个**（每个黑洞结束生成一个）

### 1.4 负能量砖块行为
```
生成：
  累积值 = 黑洞期间范围内所有能量伤害总和 × 转化率(30%~50%)
  负能量HP = -累积值
  位置 = 黑洞中心

行为：
  - 跟随砖块下移速度一起移动
  - 受到能量伤害 → 负值增大（继续充能！）
  - 受到非能量伤害 → 无效（忽略）
  - 受黑洞吸引 → 被拉回中心继续充能
  - 多个负能量砖块互相不湮灭
  - 视觉非常醒目（大号、漩涡动画、反向粒子）

湮灭触发（碰到普通砖块时）：
  dmg = min(abs(负能量HP), 砖块HP)
  砖块HP -= dmg
  负能量HP += dmg（负值趋近0）
  if 负能量HP >= 0 → 消失
  if 砖块HP <= 0 → 砖块死亡（正常掉落）
  可连续湮灭多个砖块！

存活上限：15s 或负能量耗尽
```

### 1.5 核心联动循环
```
黑洞A结束 → 生成负能量砖块A(-2000)
  ↓
黑洞B开启 → 吸引负能量砖块A到中心
  ↓
离子射线锁定负能量砖块A → 负值增长(-2000→-5000→-8000)
  ↓
黑洞B结束 → 生成负能量砖块B(-3000)
  ↓
场上有两个负能量砖块：A(-8000) + B(-3000)
  ↓
负能量砖块随砖块下移 → 碰到普通砖块 → 大规模湮灭
```

---

## 2. 数值

| 参数 | 基础值 | 说明 |
|------|--------|------|
| basePct | 20 | 黑洞自身伤害基数 |
| interval | 10000ms | 发射CD |
| 吸引半径 | 100px | 大范围吸引 |
| 持续时间 | 4s | 黑洞存在时间 |
| 吸力 | 0.5px/帧 | 砖块向中心移速 |
| tick频率 | 500ms | 伤害间隔 |
| %HP伤害上限 | baseAttack × 15 | 防Boss秒杀 |
| 负能量转化率 | 30% | 基础转化率 |
| 负能量砖块存活 | 15s | 超时消失 |

---

## 3. 技能树（9分支，3线路）

```
吞噬线：引力强化(5) → 事件视界(2)  → 奇点(2)
湮灭线：负能量(3)   → 暗物质(2)    → 湮灭链(2)   [需暗物质1+强化3]
扩张线：频率(3)     → 双星系统(2)  → 引力透镜(2)  [需双星1+频率2]
```

### 吞噬线 — 黑洞本体
| 分支 | 名称 | max | 效果 |
|------|------|-----|------|
| damage | 引力强化 | 5 | 吸力+20%/级，范围+12px/级 |
| horizon | 事件视界 | 2 | 每tick额外造成砖块HP上限×2%/级（上限baseAttack×15） |
| singularity | 奇点 | 2 | 持续时间+1.5s/级，中心30px内伤害翻倍 |

### 湮灭线 — 负能量玩法
| 分支 | 名称 | max | 效果 |
|------|------|-----|------|
| negaEnergy | 负能量 | 3 | 解锁负能量砖块。转化率30%→40%→50%，吸收系数+20%/级 |
| darkMatter | 暗物质 | 2 | 负能量砖块体积+30%/级，存活时间无限（直到耗尽） |
| annihilate | 湮灭链 | 2 | 湮灭时冲击波50+20px/级，溅射湮灭值×25%/级 |

### 扩张线 — 多黑洞
| 分支 | 名称 | max | 效果 |
|------|------|-----|------|
| freq | 频率 | 3 | CD-2s/级（10→8→6→4），最低3s |
| count | 双星系统 | 2 | 同时存在黑洞上限+1/级（1→2→3） |
| lens | 引力透镜 | 2 | 范围内能量伤害+12%/级，闪电链跳距+50%，离子射线对负能量砖块吸收率翻倍 |

### 交叉依赖
- 湮灭链(annihilate)：需 暗物质(darkMatter)≥1 + 引力强化(damage)≥3
- 引力透镜(lens)：需 双星系统(count)≥1 + 频率(freq)≥2

---

## 4. 伤害标签

| key | 中文名 | 说明 |
|-----|--------|------|
| gravityWell | 奇点引擎 | 黑洞tick基础伤害 |
| gravityWell_pctHp | 事件视界 | 百分比HP伤害 |
| negaBrick | 湮灭 | 负能量砖块湮灭伤害 |
| negaBrick_splash | 湮灭冲击 | 湮灭溅射伤害 |

---

## 5. 视觉设计

### 黑洞本体
- 中心：暗紫黑色圆形漩涡（旋转动画）
- 外围：紫色扭曲光环 + 吸入粒子流
- 被吸引砖块：拖尾紫色粒子轨迹
- 能量累积：中心显示累积数字不断增长

### 负能量砖块（非常醒目！）
- 比普通砖块大1.5倍
- 暗紫色半透明 + 内部漩涡动画
- 大号白色负数（-8000）+ 紫色外发光
- 边缘持续放出反向粒子（从外向内吸入）
- 受能量伤害时闪白+体积脉冲
- 移动时暗紫色残影拖尾
- 湮灭时大范围紫白闪光 + 冲击波圆环

---

## 6. 战术定位

- **单独用**：吸引聚拢 + tick伤害 + 小负能量砖块
- **配闪电链**：砖块分散不融合 → 跳跃效率最大化
- **配离子射线**：锁定负能量砖块疯狂充能 → 养出超大湮灭炸弹
- **配寒冰发生器**：砖块被吸引撞冰墙 → 双重消耗
- **终极combo**：黑洞聚拢 → 闪电链刷伤害 → 离子射线充能负能量 → 湮灭爆炸清屏
