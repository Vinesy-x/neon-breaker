# 武器外部养成平衡指南

> 最近更新: 2026-03-01 R8 验证通过

## 核心标定

**每10级商店等级 ≈ DPS ×3**

| 等级段 | 目标倍率 | 实测范围 |
|--------|---------|---------|
| Lv1→10 | 基准 | — |
| Lv10→20 | ×3 | ×2.19 ~ ×3.49 |
| Lv20→30 | ×3 | ×2.90 ~ ×3.92 |

## DPS 增长的三个乘区

### 乘区1: 共享伤害倍率（所有武器一样）

**文件**: `ShopCurveConfig.js`

```js
dmgMultPerBracket: [0.12, 0.20, 0.35, 0.36, 0.38]
//                  Lv1-5  6-10  11-15 16-20  21+
```

- 5的倍数级跳过（留给爽点）
- 每段有效级数 = 4级

| 等级 | 累计倍率 | 段间比 |
|------|---------|--------|
| Lv10 | ×2.28 | — |
| Lv20 | ×5.12 | ×2.25 |
| Lv30 | ×8.64 | ×1.69 |

**共享暴伤曲线**:
```js
critBonusPerBracket: [0.01, 0.02, 0.03, 0.04, 0.05]
```
单武器满级累计约+100%暴伤。11武器全满级时暴伤叠加很高。

### 乘区2: 武器爽点属性（每5级触发一次）

爽点是武器的**核心缩放机制**，决定了DPS曲线形状。

| 武器 | 爽点类型 | base | delta/5级 | Lv10 | Lv20 | Lv30 | 效果 |
|------|---------|------|-----------|------|------|------|------|
| 冰爆弹 | CD缩短 | 2700ms | -150ms | 2400ms | 2100ms | 1800ms→**封顶3000ms** | 频率乘区 |
| 闪电链 | 链数+1 | 3 | +1 | 5 | 7 | 9 | 覆盖面乘区 |
| 穿甲弹 | 齐射数 | 1 | +1 | 3(2列) | 5(3列) | 7(4列) | 弹数×列数乘区 |
| 轰炸机 | CD缩短 | 12000ms | -1500ms | 9000ms | 6000ms | 3000ms | 频率乘区 |
| 无人机 | CD缩短 | 450ms | -30ms | 390ms | 330ms | 270ms | 频率乘区 |
| 回旋刃 | 持续时间 | 10s | +0.5s | 11s | 12s | 13s | 覆盖时间乘区 |
| 白磷弹 | 持续时间 | 3s | +0.5s | 4s | 5s | 6s | DOT时间乘区 |
| 离子射线 | 持续时间 | 2s | +0.3s | 2.6s | 3.2s | 3.8s | 射击时间乘区 |
| 奇点引擎 | 持续时间 | 3s | +0.5s | 4s | 5s | 6s | 吸引时间乘区 |
| 寒冰发生器 | 冰墙数 | 2 | +1 | 4 | 6 | 8 | 覆盖面乘区 |
| 飞机 | 射速倍率 | 1.0 | +0.08 | 1.16 | 1.32 | 1.48 | 频率乘区 |

### 乘区3: 被动/分支解锁（特定等级触发）

被动在 Lv6/14/22/26/30 解锁，分支在 Lv2/10/18 解锁。

**设计原则**: 被动应该是**加法增益**（+30%、+50%），不要做**乘法爆炸**（×2、×3）。

**反面教材**: 
- 末日弹幕原来×2弹数 → 改为×1.5
- 雷神降临原来×2伤害/30s → 改为×1伤害/60s

## 当前四武器关键系数

### 冰爆弹 (kunai)
```
basePct: 5, interval: 6000ms, damageType: ice
aoeRadius: 1.2列宽(~64px), splashDmg: 60%
CD下限: 3000ms（防止爽点压到过快）
连锁爆炸: 半径封顶100px, 最多3个, 伤害×0.6衰减
末日弹幕(Lv30): 弹数×1.5（非×2）
```

### 闪电链 (lightning)
```
basePct: 5.0, interval: 3800ms, damageType: lightning
baseChains: 3, 链衰减: 15%/跳
雷神降临(Lv30): 60s CD（读配置thorInterval）, 伤害×1（非×2）
```

### 穿甲弹 (missile)
```
basePct: 32, interval: 4500ms, damageType: physical
basePierce: 8, 衰减: 8%/穿
齐射扩列规则: 每2发扩1列, 最多4列
  Lv10(3发)→2列, Lv20(5发)→3列, Lv30(7发)→4列
弹分配: 按列砖块密度排序，密集列多分弹
连射间隔: 150ms/发
冲击波(Lv26被动): 溅射100%伤害到左右相邻砖
```

### 轰炸机 (meteor)
```
basePct: 12, interval: 12000ms(base), damageType: fire
baseBombs: 4, 每分支级+2
投弹方式: 按屏幕空间等分, 80%屏宽覆盖
凝固汽油(Lv14): 火区带状, 占总DPS ~15%
```

## R8 验证数据

### 单武器 DPS
| 武器 | Lv10 | Lv20 | Lv30 | 10→20 | 20→30 |
|------|------|------|------|-------|-------|
| 冰爆弹 | 2,613 | 5,726 | 22,369 | ×2.19 | ×3.91 |
| 闪电链 | 1,912 | 5,133 | 20,747 | ×2.68 | ×4.04 |
| 穿甲弹 | 1,458 | 5,084 | 19,950 | ×3.49 | ×3.92 |
| 轰炸机 | 2,414 | 6,929 | 20,102 | ×2.87 | ×2.90 |

**Lv30 最强/最弱 = 1.3x** ✅

### 全武器满级联合占比
| 武器 | 占比 |
|------|------|
| 冰爆弹 | 36.5% |
| 轰炸机 | 31.4% |
| 闪电链 | 20.9% |
| 穿甲弹 | 10.7% |

## 新武器设计检查清单

1. **定 basePct + interval** — 参考同类型（AOE/单体/DOT）已有武器
2. **定爽点类型** — CD型(频率乘区)还是数量型(覆盖面乘区)？
3. **预估 Lv10/20/30 DPS** — 用公式: baseDmg × 共享倍率 × 爽点效果 × 被动加成
4. **跑沙盒验证** — `__dpsSandbox({weapon:'xxx', duration:60, speed:10, targetAlive:60})`
5. **检查 Lv30 是否在 15k-25k 范围内**（当前四武器均值 ~20k）
6. **检查被动有无乘法爆炸** — 禁止×2以上的纯乘法被动
7. **检查联合占比** — 单武器不应超过40%

## 沙盒测试方法

```js
// 单武器测试
sm._data.weaponLevels['xxx'] = 30;
__dpsSandbox({weapon:'xxx', duration:60, speed:10, targetAlive:60});

// 全武器测试
for(var w of allWeapons) sm._data.weaponLevels[w] = 30;
__dpsSandbox({duration:90, speed:10, targetAlive:60});

// 取结果
var st = __sandbox.stats;
st.totalDamage / (st.measureElapsed/1000); // DPS
st.damageBySource; // 各源伤害
```
