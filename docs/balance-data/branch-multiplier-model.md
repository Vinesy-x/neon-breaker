# 🔢 分支乘数模型 (Branch Multiplier Model)

> 核心公式：**满分支DPS = Lv1理论DPS × n^totalPoints**
> 其中 n = 每个分支点的等效DPS乘数

## 设计目标

每个分支点平均贡献约 **+50% DPS**（即 n ≈ 1.50 的等效效果）。
但实际上各分支效果差异很大：damage 是加法堆叠，storm 是乘法翻倍，paralyze 不加DPS。
因此用「等效 n」来统一衡量：**n = (总乘数)^(1/总点数)**。

## ⚡ 闪电链 (Lightning) — 详细拆解

### 分支效果

| 分支 | 点数 | 效果 | DPS乘数 | 依据 |
|------|------|------|---------|------|
| damage | 10 | +50%/点(加法) | ×6.00 | (1+10×0.5)/(1+0×0.5) |
| chains | 4 | +2链/点 | ×3.67* | 3链→11链(无衰减!) |
| charge | 2 | 每跳+25%伤/级 | ×3.50* | sum(1+c×0.5)/chains vs sum(1)/chains |
| shock | 2 | DOT 20%/秒×2秒 | ×1.30 | 估算,含感电电弧 |
| echo | 2 | 40%概率再释放 | ×1.56 | 1+0.4+0.16(depth≤3) |
| storm | 2 | +1道闪电/级 | ×3.00 | 1→3道 |
| paralyze | 2 | 减速30%/级 | ×1.00 | 不直接加DPS |
| overload | 1 | 末端AOE爆炸 | ×1.20 | 估算 |

> *chains+charge协同：无分支=3链×1伤=3 effHits，满分支=11链×递增=38.5 effHits → 联合 ×12.83

### 计算

```
总乘数 = 6.00 × 12.83 × 1.30 × 1.56 × 3.00 × 1.00 × 1.20 = 562x
总点数 = 25
等效 n = 562^(1/25) = 1.288
```

### 验证

| 指标 | 值 |
|------|-----|
| Lv1 理论DPS (0分支) | 6.1 |
| 预测满分支DPS | 6.1 × 562 = 3,429 |
| 沙盒实测满分支DPS | 4,098 |
| 误差 | **-16.3%** (shock/overload估算偏保守) |

### ⚠️ 重要发现

**闪电链没有链衰减！** 代码中每跳伤害 = baseDamage × chainMult，无 0.85^c 因子。
BALANCE_FINAL.md 中记录的 `chainDecayBase=0.15` 是**过时信息**，需更正。

---

## 通用 n 值参考

| 预期效果 | n 值 | 25点总乘数 |
|---------|------|-----------|
| 保守(+20%/点) | 1.20 | 95x |
| 标准(+30%/点) | 1.30 | 705x |
| 激进(+50%/点) | 1.50 | 25,252x |

闪电链实测 n=1.288 → 接近「标准」档位，合理。

## 待测试

- [ ] 冰爆弹分支拆解 + n 值
- [ ] 穿甲弹分支拆解 + n 值
- [ ] 轰炸机分支拆解 + n 值
- [ ] 四武器 n 值对比 → 验证一致性

---

*2026-03-02 阿喵建模*
